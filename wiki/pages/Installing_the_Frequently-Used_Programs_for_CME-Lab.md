## Installing and Configuring the Frequently-Used Programs for the CME-Lab ##

This guide assumes that your Chromebook already has GalliumOS on it (Check the [[Brand New Chromebook from the Box]] guide if not), and that you have your own user account (as outlined in the [[Installing the Frequently-Used Programs for CME-Lab]]).

In this guide, you will learn how to perform OS updates, as well as get various important programs set up on your Chromebook.

### Updating the Operating System ###

System updates are very important. In this section, you will learn how to upgrade the OS with the latest package and security updates.

1. Hit `Ctrl` + `Alt` + `T` to open up a terminal and type:

    ```sudo apt update ```

    ```sudo apt dist-upgrade```

    In each case, you will have to hit `Y`, `Enter` to continue.

1. If you get messages about configuration files on the system being different from the package maintainer's version, select the package maintainer's version rather than the local version on the system ***IMAGE***.

### Installing Packages Needed to Complete Other Installations ###

1. In order to install the rest of the programs, some prerequisites must be treated first. The following command can be run to install all of the different bits needed on the machine. As before, you will need to hit `Y` and `Enter` to begin the installation process:

```sudo apt install build-essential cmake git ssh vim  network-manager-openconnect network-manager-openconnect-gnome zlib1g-dev```


### Setting up the Virtual Private Network (VPN) ###

In order to connect to the supercomputing clusters at Boise State (i.e. "Fry", "Kestrel", and "R2") when you are off-campus, or not connected to eduroam, you will need to set up a Virtual Private Network (VPN). To do this, follow the steps below.

1. Click on the bottom right WiFi glyph
1. Select edit connections
1. Then select "Add"
1. From the drop down list select the CiscoAnyconnect compatible option
(If the option does not exist, try and run `sudo service network-manager restart` in a terminal)
1. Name the connection "BSU On Campus"
1. On the gateway field enter: `bsuvpn-oncampus.boisestate.edu`. The other options can be left as their default values.
1. Click "Save"
1. Select "Add"
1. From the drop down list select the CiscoAnyconnect compatible option
1. Name the connection "BSU Off Campus"
1. On the gateway field enter: `bsuvpn-offcampus.boisestate.edu`. The other options can be left as their default values.
1. Click "Save"
1. In order to connect to the VPN, select the WiFi glyph in the bottom right, hover over "VPN Connections" and select the appropriate connection (for instance, if on `eduroam` wifi, select "BSU On Campus"). 
1. You will be prompted for your Boise State username and password. 
1. Clicking "Login" will complete the process.

To test that the VPN is working correctly, try logging into your account on Kestrel!

1. Open the terminal if it isn't already, by pressing `Ctrl` + `Alt` + `T`.
1. Type `ssh <username>@kestrel`, where `<username>` should be replaced with your kestrel account name.
1. You will be prompted for your Kestrel password (Note that this is probably different to your Boise State password, unless you have changed it yourself!). Note that no characters will show up as you type, so don't be alarmed.
1. The first time you connect, you will be given an RSA fingerprint and ask if you want to continue connecting. Just type `yes` and hit `Enter`.
1. Once connected, you should see a terminal and can now navigate through the cluster using the normal bash commands.
1. Remember to type "exit" and hit `Enter` when done, to return to the local machine!



### Installing Visual Molecular Dynamics (VMD) ###

In the cme-lab, we frequently us VMD to visualize the trajectories from our molecular dynamics simulations.

1. Use the following link to download VMD: [VMD Install](https://drive.google.com/file/d/0BwrDd9rKbqideno1V0tMTFg1bmM/view?usp=sharing).

1. Extract and install VMD:

```
# Change directory to the downloads folder
cd ~/Downloads/
tar -xf vmd-1.9.3.bin.LINUXAMD64-CUDA8-OptiX4-OSPRay111p1.opengl.tar.gz 
cd vmd-1.9.3/
./configure
cd src/
sudo make install
```


In order to read the `gsd` files generated by HOOMD2, an additional `gsd` plugin is also needed:

```
#Let's make a projects folder to keep source code organized  
cd ~
mkdir Projects
cd Projects/
git clone https://github.com/mphoward/gsd-vmd
cd gsd-vmd/
mkdir build && cd build
cmake ..
make install 
```

VMD and its `gsd` reader are now installed.


### Generating SSH Keys ###


Setting up an ssh key is very useful, as it means that you can log onto clusters and use git without having to type in a username and password. To do so, use the command `ssh-keygen` and keep pressing `Enter` to accept the defaults. Note that it is important to keep the passphrase field empty if you want to avoid typing in passwords!

```
ssh-keygen 
# Generating public/private rsa key pair.
# Enter file in which to save the key (/home/mhenry/.ssh/id_rsa): 
# Enter passphrase (empty for no passphrase): 
# Enter same passphrase again: 
# Your identification has been saved in /home/mhenry/.ssh/id_rsa.
# Your public key has been saved in /home/mhenry/.ssh/id_rsa.pub.
```

You can copy the data in the `id_rsa.pub` file into the "SSH keys" section of your account settings in Bitbucket to enable password-free git control, or to the `~/.ssh/authorized_keys` file on the cluster in question (you can safely make the `authorized_keys` file if it doesn't exist).


### Installing Dot Files ###

The cme-lab has a selection of useful, basic configuration files for many of the programs we use (e.g. vmd, vim, matplotlib etc.). You can clone these files onto your own machine to keep up to date with the lab style! You can access these configuration "dot" files by doing the following:
 
```
git clone git@bitbucket.org:cmelab/getting-started.git
# Note: This command will fail, unless you have added your ssh key to bitbucket as described above. Either do so, or use the https:// link to clone the repo!
cd getting-started/config_files/
make
```
This should copy over all of the dot files to give you some sane defaults. Feel free to play around and customize the dot files. You may have to change some terminal settings since the default terminal doesn't work well with the vim color scheme. It is recommended that you keep the .matplotlibrc file the same to ensure uniformity between all of the lab's graphs and figures.


### Installing Conda ###

NOTE: We might move this section out if the `conda` installs take up too much room.

Conda is a useful tool that we can use to install packages and programs easily, as well as create virtual environments that allow us to use specific versions of packages when we need them. A full description of conda's utility is beyond the scope of this guide, but the following describes how to get conda set up initially.


```
cd ~/Downloads/

Linux:
wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
bash Miniconda3-latest-Linux-x86_64.sh

MacOS:
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-MacOSX-x86_64.sh
bash Miniconda3-latest-MacOSX-x86_64.sh

```
1. Then hit `enter` to view the license agreement.
2. Hit `q` to skip reading the license agreement (tldr; BSD 3 clause, crypto might have export restrictions)
3. Type `yes`
4. Hit `enter`to install conda in default location
5. Type `yes` to prepend your path with the conda install location

In order to use `conda` after installation, you will have to reload your bash profile by typing `source ~/.bashrc`. This is only necessary in terminal windows that were already open before conda was installed - new terminal windows will already have `conda` added correctly to your path variable. To verify that the install worked, see if the output of `which python` looks something like `/home/<username>/miniconda3/bin/python` 


TODO:

* Test if gsd plugin works for other users
* Maybe change order to install default rc files? I can put them into /etc/skel/
* Add Avogadro info, or a link out to other medium-frequency programs?